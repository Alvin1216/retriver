{% extends 'ft_retriver/base2.html' %}
{% load staticfiles %}

{% block content %}
<section class="engine"><a href="https://mobirise.info/m">site design templates</a></section>
<section class="mbr-section content5 cid-rE83tuXctg mbr-parallax-background" id="content5-8">
    <div class="container">
        <div class="media-container-row">
            <div class="title col-12 col-md-8">
                <h2 class="align-center mbr-bold mbr-white pb-3 mbr-fonts-style display-1">SEARCH RESULT</h2>
                <h3 class="mbr-section-subtitle align-center mbr-light mbr-white pb-3 mbr-fonts-style display-5">
                    在 {{file_name}} 中搜尋的關鍵字 {{keyword}} 的結果
                </h3>
                <div class="align-center" style="font-family:Microsoft JhengHei; color:white;">
                    {% if type == 'xml' %}
                    <h4>檔案 {{file_name}} 中一共有 {{numbers}} 篇含有標題與摘要的文章</h4>
                    <h4> 檔案 {{file_name}} 中一共有 {{hit}} 篇文章的標題或摘要中含有你想要的關鍵字 </h4>
                    {% else %}
                    <h4>檔案 {{file_name}} 中一共有 {{numbers}} 篇推文</h4>
                    <h4>檔案 {{file_name}} 中一共有 {{hit}} 篇推文含有你想要的關鍵字</h4>
                    {%endif%}
                </div>
            </div>
        </div>
    </div>
</section>

<section class="mbr-section article content1 cid-rE83tw0Bwd" id="content2-9">
    <div class="container" style="font-family:Microsoft JhengHei;">
        {% for as in artical_set%}
        <div class="card" style="margin-bottom: 5px;">
            <!--            <h5 class="card-header"><b>{% autoescape off %} {{as.title}} {% endautoescape %}</b></h5>-->
            <div class="card-header">
                <a data-toggle="collapse" data-target="#collapse-{{ as.id }}"><h5>
                    <i class="fas fa-chevron-down"></i>
                    <b>{% autoescape off %} {{as.title}} {% endautoescape %}</b>
                </h5>
                </a>
            </div>
            <div id="collapse-{{ as.id }}" class="panel-collapse collapse">
                <div class="card-body">
                    <!--<h5 class="card-title">Special title treatment</h5>-->
                    <p>{% autoescape off %} {{as.content}} {% endautoescape %}</p>

                    {% if type == 'xml' %}
                    <div class="alert alert-light" role="alert" style="color:black;">
                        <h4 class="alert-heading">-關於這篇文章的詳細資訊-</h4>
                        <hr>
                        <ol style="list-style-type:lower-roman;">
                            <li>這篇標題中有 <span style="color:red;">{{as.keyword_title_hit}} </span>個關鍵字</li>
                            <li>這篇摘要中有 <span style="color:red;">{{as.keyword_content_hit}} </span>個關鍵字</li>
                            <li>這篇摘要有 <span style="color:red;">{{as.character_content}}</span> 個字元</li>
                            <li>這篇摘要有 <span style="color:red;">{{as.word_content}}</span> 個詞</li>
                            <li>這篇摘要有 <span style="color:red;">{{as.sentence_content}} </span>個句子</li>
                            <li>{{as.wordset}}</li>
                            <li>摘要中 有重要的字嗎? {{as.common}}</li>
                            <li>
                                <canvas id="{{ as.ca_id_xml }}" width="400" height="200"></canvas>
                                <script>
                                    var ctx = document.getElementById('{{ as.ca_id_xml | safe }}');
                                    var myChart = new Chart(ctx, {
                                        type: 'line',
                                        data: {
                                            labels: {{as.words|safe}},
                                            datasets: [{
                                                label: 'area',
                                                data: {{as.value|safe}},
                                                backgroundColor: [
                                                    'rgba(255, 140, 0, 0.5)'
                                                ],
                                                borderColor: [
                                                    'rgba(255, 0, 255, 1)'
                                                ],
                                                borderWidth: 1
                                            }]
                                        },
                                        options: {
                                            scales: {
                                                yAxes: [{
                                                    ticks: {
                                                        beginAtZero: true
                                                    }
                                                }]
                                            },
                                            title: {
                                                display: true,
                                                text:'The Zipf distribution of this article'
                                            }
                                        }
                                    });


                                </script>
                            </li>
                            <li>
                                <canvas id="{{as.ca_id_xml_p}}" width="400" height="200"></canvas>
                                <script>
                                    var ctx2 = document.getElementById('{{as.ca_id_xml_p|safe}}');
                                    var myChart2 = new Chart(ctx2, {
                                        type: 'line',
                                        data: {
                                            labels: {{as.words_p|safe}},
                                            datasets: [{
                                                label: 'area',
                                                data: {{as.value_p|safe}},
                                                backgroundColor: [
                                                    'rgba(255, 0, 0, 0.5)'
                                                ],
                                                borderColor: [
                                                    'rgba(255, 0, 255, 1)'
                                                ],
                                                borderWidth: 1
                                            }]
                                        },
                                        options: {
                                            scales: {
                                                yAxes: [{
                                                    ticks: {
                                                        beginAtZero: true
                                                    }
                                                }]
                                            },
                                            title: {
                                                display: true,
                                                text:'Stemmed by porter algorithm'
                                            }
                                        }
                                    });


                                </script>
                            </li>
                            <li>
                                <canvas id="{{as.len_id_xml}}" width="400" height="200"></canvas>
                                <script>
                                    var ctx2 = document.getElementById('{{as.len_id_xml|safe}}');
                                    var myChart2 = new Chart(ctx2, {
                                        type: 'bar',
                                        data: {
                                            labels: ['original_wordset_len','stemmed_wordset_len'],
                                            datasets: [{
                                                label: 'compares',
                                                data: [{{as.wordset_len|safe}},{{as.wordset_p_len|safe}}],
                                                backgroundColor: [
                                                    'rgba(0, 0, 255, 0.5)',
                                                    'rgba(0, 255, 0, 0.5)'
                                                ],
                                                borderColor: [
                                                    'rgba(0, 0, 0, 1)',
                                                    'rgba(0, 0, 0, 1)'

                                                ],
                                                borderWidth: 1
                                            }]
                                        },
                                        options: {
                                            scales: {
                                                yAxes: [{
                                                    ticks: {
                                                        beginAtZero: true
                                                    }
                                                }],
                                                xAxes: [{
                                                    barPercentage: 0.4
                                                }]
                                            },
                                            title: {
                                                display: true,
                                                text:'Compare with 2 words set'
                                            }
                                        }
                                    });


                                </script>
                            </li>
                            <li>未經過詞幹提取的字詞set長度：{{as.wordset_len|safe}}</li>
                            <li>經過詞幹提取後字詞set長度：{{as.wordset_p_len|safe}}</li>

                            <hr>

                            <div style="text-align:center;">
                                <h5>詳細內容（右半邊 經過詞幹提取/左半邊 未經過詞幹提取)</h5>
                                <table class="table table-sm">
                                    <thead>
                                    <tr>
                                        <th scope="col">#</th>
                                        <th scope="col">original_key</th>
                                        <th scope="col">original_value</th>
                                        <th scope="col">stemmed_key</th>
                                        <th scope="col">stemmed_key_value</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    {% for display in as.display_list %}
                                    <tr>
                                        <th scope="row">{{display.row}}</th>
                                        <td>{{display.key}}</td>
                                        <td>{{display.value}}</td>
                                        <td>{{display.key_p}}</td>
                                        <td>{{display.value_p}}</td>
                                    </tr>
                                    {%endfor%}
                                    </tbody>

                                </table>
                            </div>
                        </ol>
                    </div>
                    {%endif%}

                    {% if type == 'json' %}
                    <div class="alert alert-light" role="alert" style="color:black;">
                        <h4 class="alert-heading">-關於這篇推文的詳細資訊-</h4>
                        <hr>
                        <ol style="list-style-type:lower-roman;">
                            <li>這篇推文有 <span style="color:red;">{{as.keyword_content_hit}} </span>個關鍵字</li>
                            <li>這篇推文有 <span style="color:red;">{{as.character_content}} </span>個字元</li>
                            <li>這篇推文有 <span style="color:red;">{{as.word_content}} </span>個詞</li>
                            <li>這篇推文有 <span style="color:red;">{{as.sentence_content}} </span>個句子</li>
                            <li>{{as.wordset}}</li>
                            {% if as.tag != '' %}
                            <li>Hashtag:{% autoescape off %}{{as.tag}}{% endautoescape %}</li>
                            {%endif%}

                            {% if as.http != '' %}
                            <li>內含的url :{% autoescape off %}{{as.http}}{% endautoescape %}</li>
                            {%endif%}
                            <li>有重要的字嗎? {{as.common}}</li>
                            <li>
                                <canvas id="{{ as.ca_id_json }}" width="400" height="200"></canvas>
                                <script>
                                    var ctx = document.getElementById('{{ as.ca_id_json | safe }}');
                                    var myChart = new Chart(ctx, {
                                        type: 'line',
                                        data: {
                                            labels: {{as.words|safe}},
                                            datasets: [{
                                                label: 'area',
                                                data: {{as.value|safe}},
                                                backgroundColor: [
                                                    'rgba(255, 140, 0, 0.5)'
                                                ],
                                                borderColor: [
                                                    'rgba(255, 0, 255, 1)'
                                                ],
                                                borderWidth: 1
                                            }]
                                        },
                                        options: {
                                            scales: {
                                                yAxes: [{
                                                    ticks: {
                                                        beginAtZero: true
                                                    }
                                                }]
                                            },
                                            title: {
                                                display: true,
                                                text:'The Zipf distribution of this article'
                                            }
                                        }
                                    });


                                </script>
                            </li>
                            <li>
                                <canvas id="{{ as.ca_id_json_p }}" width="400" height="200"></canvas>
                                <script>
                                    var ctx = document.getElementById('{{ as.ca_id_json_p | safe }}');
                                    var myChart = new Chart(ctx, {
                                        type: 'line',
                                        data: {
                                            labels: {{as.words_p|safe}},
                                            datasets: [{
                                                label: 'area',
                                                data: {{as.value_p|safe}},
                                                backgroundColor: [
                                                    'rgba(0, 0, 255, 0.5)'
                                                ],
                                                borderColor: [
                                                    'rgba(255, 0, 255, 1)'
                                                ],
                                                borderWidth: 1
                                            }]
                                        },
                                        options: {
                                            scales: {
                                                yAxes: [{
                                                    ticks: {
                                                        beginAtZero: true
                                                    }
                                                }]
                                            },
                                            title: {
                                                display: true,
                                                text:'Stemmed by porter algorithm'
                                            }
                                        }
                                    });


                                </script>
                            </li>
                            <li>
                                <canvas id="{{as.len_id_json}}" width="400" height="200"></canvas>
                                <script>
                                    var ctx2 = document.getElementById('{{as.len_id_json|safe}}');
                                    var myChart2 = new Chart(ctx2, {
                                        type: 'bar',
                                        data: {
                                            labels: ['original_wordset_len','stemmed_wordset_len'],
                                            datasets: [{
                                                data: [{{as.wordset_len|safe}},{{as.wordset_p_len|safe}}],
                                                backgroundColor: [
                                                    'rgba(0, 255, 255, 0.5)',
                                                    'rgba(255, 255, 0, 0.5)'
                                                ],
                                                borderColor: [
                                                    'rgba(0, 0, 0, 1)',
                                                    'rgba(0, 0, 0, 1)'

                                                ],
                                                borderWidth: 1
                                            }]
                                        },
                                        options: {
                                            scales: {
                                                yAxes: [{
                                                    ticks: {
                                                        beginAtZero: true
                                                    }
                                                }],
                                                xAxes: [{
                                                    barPercentage: 0.4
                                                }]
                                            },
                                            title: {
                                                display: true,
                                                text:'Compare with 2 words set'
                                            }
                                        }
                                    });


                                </script>
                            </li>
                            <li>未經過stemmed的字詞set長度：{{as.wordset_len|safe}}</li>
                            <li>經過stemmed後字詞set長度：{{as.wordset_p_len|safe}}</li>

                            <hr>

                            <div style="text-align:center;">
                                <h5>詳細內容（右半邊 經過詞幹提取/左半邊 未經過詞幹提取)</h5>
                                <table class="table table-sm">
                                    <thead>
                                    <tr>
                                        <th scope="col">#</th>
                                        <th scope="col">original_key</th>
                                        <th scope="col">original_value</th>
                                        <th scope="col">stemmed_key</th>
                                        <th scope="col">stemmed_key_value</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    {% for display in as.display_list %}
                                    <tr>
                                        <th scope="row">{{display.row}}</th>
                                        <td>{{display.key}}</td>
                                        <td>{{display.value}}</td>
                                        <td>{{display.key_p}}</td>
                                        <td>{{display.value_p}}</td>
                                    </tr>
                                    {%endfor%}
                                    </tbody>

                                </table>
                            </div>
                        </ol>
                    </div>
                    {%endif%}
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</section>
{% endblock %}